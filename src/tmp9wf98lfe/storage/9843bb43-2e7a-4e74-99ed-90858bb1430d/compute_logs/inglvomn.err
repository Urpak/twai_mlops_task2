[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - LOGS_CAPTURED - Started capturing logs in process (pid: 575912).
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - STEP_START - Started execution of step "linear_regression".
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - linear_regression - Loading file from: /home/kai/Git/twai_mlops_assignment2-main/src/tmp9wf98lfe/storage/test_data using PickledObjectFilesystemIOManager...
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - LOADED_INPUT - Loaded input "test_data" using input manager "io_manager", from output "test_data" of step "train_test_data"
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - linear_regression - Loading file from: /home/kai/Git/twai_mlops_assignment2-main/src/tmp9wf98lfe/storage/train_data using PickledObjectFilesystemIOManager...
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - LOADED_INPUT - Loaded input "train_data" using input manager "io_manager", from output "train_data" of step "train_test_data"
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - STEP_INPUT - Got input "test_data" of type "DataFrame". (Type check passed).
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - STEP_INPUT - Got input "train_data" of type "DataFrame". (Type check passed).
[32m2024-12-10 17:37:18 +0100[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 9843bb43-2e7a-4e74-99ed-90858bb1430d - 575912 - linear_regression - STEP_FAILURE - Execution of step "linear_regression" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "linear_regression"::

ValueError: Input X contains NaN.
LinearRegression does not accept missing values encoded as NaN natively. For supervised learning, you might want to consider sklearn.ensemble.HistGradientBoostingClassifier and Regressor which accept missing values encoded as NaNs natively. Alternatively, it is possible to preprocess the data, for instance by using an imputer transformer in a pipeline or drop samples with missing values. See https://scikit-learn.org/stable/modules/impute.html You can find a list of all estimators that handle NaN values at the following page: https://scikit-learn.org/stable/modules/impute.html#estimators-that-handle-nan-values

Stack Trace:
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 54, in op_execution_error_boundary
    yield
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 490, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 140, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 128, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
                                                                    ^^^^^^^^^^^^^^^^^^
  File "/home/kai/Git/twai_mlops_assignment2-main/src/bike_share/assets/models.py", line 52, in linear_regression
    create_pipeline(LinearRegression()).fit(train_input, train_output)
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/pipeline.py", line 473, in fit
    self._final_estimator.fit(Xt, y, **last_step_params["fit"])
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/base.py", line 1473, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/linear_model/_base.py", line 609, in fit
    X, y = self._validate_data(
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/base.py", line 650, in _validate_data
    X, y = check_X_y(X, y, **check_params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1301, in check_X_y
    X = check_array(
        ^^^^^^^^^^^^
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/utils/validation.py", line 1064, in check_array
    _assert_all_finite(
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/utils/validation.py", line 123, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/home/kai/miniconda3/envs/bike-share/lib/python3.12/site-packages/sklearn/utils/validation.py", line 172, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
[0m
